<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Storyteller</title> 
       
        <link rel="icon" type="image/png" href="/img/icon.jpeg">
        <link rel="stylesheet" type="text/css" href="vendors/css/normalize.css">
        <link rel="stylesheet" type="text/css" href="vendors/css/grid.css">                
        <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;1,300&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/css/style.css">
        </script>
    </head>
    <body>
        <header>
            <div class="hero-text-box">
                <h1><i>Story Teller</i></h1>
            </div>
        </header>       

        <section class="section__registry">
            <div class="section__registry--breadcrumb"> {{{breadCrumb}}}</div>
            <div class="section__registry--level-nav">
                {{{levelNav.levelNavAdd}}}
                {{{levelNav.levelNavHome}}}
                {{{levelNav.levelNavPrevious}}} 
                {{{levelNav.levelNavTop}}} 
                {{{levelNav.levelNavNext}}}
                {{{levelNav.levelNavVoid}}}
                {{{levelNav.levelNavDump}}}
                {{{levelNav.levelNavRestore}}}
            </div>
            {{#if selectedRegistry}}
            <div class="section__registry--single">
                
                <div class="section__registry--single--title"><h2>{{selectedRegistry.title}}</h2> </div>
                <div class="section__registry--single--id">({{selectedRegistry.id}})</div>
                <div class="section__registry--single--text">
                    {{selectedRegistry.text}}
                </div>                
                
                <div class="section__registry--single--actions">                    
                    <a class="button button-full" href="#" onclick="editRegistry('{{selectedRegistry.id}}')">Edit</a>
                    <a class="button button-full" href="#" onclick="deleteRegistry('{{selectedRegistry.id}}', '{{currentLevel}}')">Delete</a>
                    <a class="button button-full" href="#" onclick="addChild('{{selectedRegistry.id}}')">Add Child</a>   
                    {{#if showAddAccountables}}
                        <a class="button button-full" href="#" onclick="moveToAddAccountable('{{selectedRegistry.id}}')">Add Accountable</a>                                         
                    {{/if}}
                </div>
                {{#if selectedRegistry.imgPath}}
                    <section class="section--image-frame">
                        <div class="imgPanel">
                            <img src="{{{selectedRegistry.imgPath}}}" alt="{{{registry.title}}}"/>
                        </div>
                    </section>
                {{/if}}                

                <div class="section__registry--accountables">
                    {{#if accumulatedAccountables}}
                        {{#each accumulatedAccountables}}
                            <div class="section__registry--single--accountable"><ion-icon name="{{ionIcon}}" class="icon-small"></ion-icon> <b>{{title}}: {{amount}}</b></div>
                        {{/each}}
                        <!-- 
                            <div class="section__registry--single--accountable"><ion-icon name="trophy-outline" class="icon-small"></ion-icon> <b>stuff: 5</b></div>
                            <div class="section__registry--single--accountable"><ion-icon name="skull-outline" class="icon-small"></ion-icon> <b>words: 25</b></div>
                            <div class="section__registry--single--accountable"><ion-icon name="fitness-outline" class="icon-small"></ion-icon> <b>questions: 7</b></div>
                        -->
                    {{/if}}
                </div>
                {{#if selectedRegistry.children}}
                    {{#if selectedRegistry.children.length}}
                        <div class="section--children">
                            {{#each selectedRegistry.children}}
                                <div class="section__registry--single--title" onclick="selectRegistry('{{id}}')">
                                    {{title}} &nbsp;&nbsp;&nbsp;                                    
                                </div>
                                <a class="button button-full" href="#" onclick="delChild('{{father}}', '{{id}}' , '{{level}}')">Remove</a>
                            {{/each}}
                            
                        </div>
                    {{/if}}
                {{/if}}
            </div>
            {{/if}}
            <div class="section__registry--list">
                <h2>{{currentLevel}}</h2>
                <ul class="section__registry-sibling-list">
                {{#each selectedRegistryTree}}
                    <div onclick="selectRegistry('{{id}}')">
                        <li>
                            {{title}}
                        </li>
                    </div>
                {{/each}}
                </ul>
            </div>

        </section>

        <footer>
            Health check - {{{this.connectionStatus}}}<br>
            &copy; pedrotfs
        </footer>
        
        <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
        <script src="/js/client-side-app.js"></script>
        {{!-- good icons: 
            footsteps-outline
            golf-outline
            diamond-outline
            earth-outline
            bonfire-outline
            analytisc-outline
            arrow-up-outline
            chatbubbles-outline
            globe-outline
            fitness-outline
            flask-outline
            pulse-outline
            ribbon-outline
            school-outline
            skull-outline
            triangle-outline
            trophy-outline
            water-outline
        --}}
    </body>
</html>